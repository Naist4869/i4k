(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["about"],{"43fd":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"postvideo"}},[o("h3",[e._v("欢迎投稿")]),o("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form}},[o("el-form-item",{attrs:{label:"视频地址"}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:"",accept:".mp4","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"before-upload":e.BeforevideoUpload,"http-request":e.videoUploadRequest,multiple:"",limit:1,"on-exceed":e.handleExceed,"file-list":e.fileList}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传MP4文件，且不超过500MB!")])],1)],1),o("el-form-item",{attrs:{label:"视频封面"}},[o("el-upload",{staticClass:"poster-uploader",attrs:{action:"","before-upload":e.fnBeforeUpload,"http-request":e.fnUploadRequest,"show-file-list":!1,accept:".png"}},[e.imageUrl?o("img",{staticClass:"poster",attrs:{src:e.imageUrl}}):o("i",{staticClass:"el-icon-plus poster-uploader-icon"}),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传png文件，且不超过2MB!")])])],1),o("el-form-item",{attrs:{label:"视频标题"}},[o("el-input",{attrs:{type:"text",placeholder:"请输入内容",maxlength:"80",minlength:"5","show-word-limit":""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),o("el-form-item",{attrs:{label:"视频详情"}},[o("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",maxlength:"80","show-word-limit":""},model:{value:e.form.info,callback:function(t){e.$set(e.form,"info",t)},expression:"form.info"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")])],1)],1)],1)},i=[],a=(o("7f7f"),o("76e5")),l=o("bc3a"),r=o.n(l),s=function(e){return r.a.post("/api/v1/upload/token",{filename:e}).then(function(e){return e.data})},f=function(e){return r.a.post("/api/v1/upload/video",{filename:e}).then(function(e){return e.data})},c={data:function(){return{imageUrl:"",fileList:[],form:{title:"",info:"",poster:"",video:""}}},methods:{handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},BeforevideoUpload:function(e){console.log(e.type);var t="video/mp4"===e.type,o=e.size/1024/1024<500;return t||this.$message.error("上传头像图片只能是 MP4 格式!"),o||this.$message.error("上传头像图片大小不能超过 500MB!"),t&&o},videoUploadRequest:function(e){var t=this;f(e.file.name).then(function(o){var n=new XMLHttpRequest;n.open("PUT",o.data.put,!0),n.send(e.file),n.onload=function(){t.fileList.push({name:"上传成功"+e.file.name}),t.form.video=o.data.key,console.log(t.fileList)}}).catch(function(e){t.$notify.error({title:"网络错误，或者服务器宕机",message:e})})},fnBeforeUpload:function(e){var t="image/png"===e.type,o=e.size/1024/1024<3;return t||this.$message.error("上传头像图片只能是 PNG 格式!"),o||this.$message.error("上传头像图片大小不能超过 3MB!"),t&&o},fnUploadRequest:function(e){var t=this;s(e.file.name).then(function(o){var n=new XMLHttpRequest;n.open("PUT",o.data.put,!0),n.send(e.file),n.onload=function(){t.imageUrl=o.data.get,t.form.poster=o.data.key}}).catch(function(e){t.$notify.error({title:"网络错误，或者服务器宕机",message:e})})},onSubmit:function(){var e=this;a["d"](this.form).then(function(t){t.status>0?e.$notify({title:"投稿失败",message:t.msg}):(e.$notify({title:"投稿成功",message:"您投稿的id为".concat(t.data.id)}),setTimeout(function(){window.open("/video/"+t.data.id,"_blank")},4e3))}).catch(function(t){e.$notify.error({title:"网络错误或者服务器宕机",message:t})})}}},u=c,p=(o("48bf"),o("2877")),m=Object(p["a"])(u,n,i,!1,null,null,null);t["default"]=m.exports},"48bf":function(e,t,o){"use strict";var n=o("65cc"),i=o.n(n);i.a},"65cc":function(e,t,o){},"7f7f":function(e,t,o){var n=o("86cc").f,i=Function.prototype,a=/^\s*function ([^ (]*)/,l="name";l in i||o("9e1e")&&n(i,l,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=about.7e0653b7.js.map